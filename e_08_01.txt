実施テキスト：達人に学ぶDB設計徹底指南書

実施者：玉利仁美
実施日：1月17日

[演習8−1] ビジネスロジックの実装方法の検討

[演習内容]
 本文で代理キーについて解説した際、テーブルに主キーを設定せず、重複行データを登録後に削除する、という間違った設計について触れました。しかし、主キーによる一意性制約に限らず、データが満たすべき様々な条件(ビジネスロジック)を、テーブルの制約ではなく、アプリケーションコードによって実装することは一般的に行われています。さて、このビジネスロジックをアプリケーションコードで実装することについて、以下の問いについて考えてください。

問い１．ビジネスロジックをアプリケーションコードで実装することの是非
問い２．ビジネスロジックをデータベースの「トリガー」で実装することの是非

回答

問い１．テーブルの制約のみでは、どうしても実装できないものがあると思うので、そういった面から考えるとアプリケーションコードを実装することは必要だと思います。ただ、アプリケーションコードを多用しすぎると、不整合が起きやすくなったり、処理に時間がかかってしまったりすると思うので、テーブル制約とアプリケーションコードの兼ね合いをしっかり考えるべきであると思います。

問い２．トリガーとはあるイベントが発生した際に自動的に実行される機能であり、これをビジネスロジックを実装する際に使用すれば、自動で処理を行ってくれると思いますが、気づかないうちにトリガーが実行されてしまったり、トリガーを実行する必要がないのにイベントを実施した際に実行されてしまったりされてしまいます。そのためトリガーが重たい処理だった場合、全体の処理速度が遅くなってしまうことがありえます。なのでトリガーを使う際はしっかり使いどころを考えて実施しなければならないと思います。自動で処理を行ってくれる機能は便利だと思うので本当に軽い処理であるイベントを実施するときは必ず実施する必要があるものだけは使ってもいいのではないかと思います。

参考資料：

